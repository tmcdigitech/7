<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.105.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/7/favicons/favicon.ico><link rel=apple-touch-icon href=/7/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/7/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/7/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/7/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/7/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/7/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/7/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/7/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/7/favicons/android-192x192.png sizes=192x192><title>On-off lamp | 7 Digital Tech</title><meta name=description content="This example shows the basics of a state machine, also known by the more technical term finite state automaton. The idea is that the program is in a particular state, and certain events will cause a transition to another state.
In our case, our light is either on or off (the states), and we will transition between them with a big enough vibration reading. Here is a state diagram of this:"><meta property="og:title" content="On-off lamp"><meta property="og:description" content="This example shows the basics of a state machine, also known by the more technical term finite state automaton. The idea is that the program is in a particular state, and certain events will cause a transition to another state.
In our case, our light is either on or off (the states), and we will transition between them with a big enough vibration reading. Here is a state diagram of this:"><meta property="og:type" content="article"><meta property="og:url" content="https://tmcdigitech.github.io/7/microcontrollers/projectideas/onofflamp/"><meta property="article:section" content="microcontrollers"><meta property="article:modified_time" content="2023-03-28T16:21:11+10:30"><meta property="og:site_name" content="7 Digital Tech"><meta itemprop=name content="On-off lamp"><meta itemprop=description content="This example shows the basics of a state machine, also known by the more technical term finite state automaton. The idea is that the program is in a particular state, and certain events will cause a transition to another state.
In our case, our light is either on or off (the states), and we will transition between them with a big enough vibration reading. Here is a state diagram of this:"><meta itemprop=dateModified content="2023-03-28T16:21:11+10:30"><meta itemprop=wordCount content="560"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="On-off lamp"><meta name=twitter:description content="This example shows the basics of a state machine, also known by the more technical term finite state automaton. The idea is that the program is in a particular state, and certain events will cause a transition to another state.
In our case, our light is either on or off (the states), and we will transition between them with a big enough vibration reading. Here is a state diagram of this:"><link rel=preload href=/7/scss/main.min.cbc85df4742aa23bc9dbc982afb21999645fcfcec09c5583d3a568f7ab1319ca.css as=style><link href=/7/scss/main.min.cbc85df4742aa23bc9dbc982afb21999645fcfcec09c5583d3a568f7ab1319ca.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/7/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>7 Digital Tech</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/7/assessment/><i class='fa fa-laptop-file'></i><span>Assessment</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/7/introduction/><i class='fa fa-power-off'></i><span>Introduction</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/7/microbit/><i class='fa fa-code'></i><span>Micro:bit</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/7/networks/><i class='fa fa-cloud'></i><span>Networks</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/7/algorithms/><i class='fa fa-code-merge'></i><span>Algorithms</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/7/microcontrollers/><i class='fa fa-microchip'></i><span class=active>Microcontrollers</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/7/glossary/><i class='fa-solid fa-circle-question'></i><span>Glossary</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/7/offline-search-index.6fcbf0241359cdb461e1d0720a626697.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/7/offline-search-index.6fcbf0241359cdb461e1d0720a626697.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-7microcontrollers-li><a href=/7/microcontrollers/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-7microcontrollers><span>Microcontrollers</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-7microcontrollers01gettingstarted-li><a href=/7/microcontrollers/01gettingstarted/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-7microcontrollers01gettingstarted><span>Getting started</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers01gettingstartedinstallation-li><a href=/7/microcontrollers/01gettingstarted/installation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers01gettingstartedinstallation><span>Software</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers01gettingstartedfilestructure-li><a href=/7/microcontrollers/01gettingstarted/filestructure/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers01gettingstartedfilestructure><span>Structuring your files</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-7microcontrollers02examples-li><a href=/7/microcontrollers/02examples/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-7microcontrollers02examples><span>Examples</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesflash-li><a href=/7/microcontrollers/02examples/flash/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesflash><span>Flash a light</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesrespond-li><a href=/7/microcontrollers/02examples/respond/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesrespond><span>Respond to input</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplescolor-li><a href=/7/microcontrollers/02examples/color/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplescolor><span>A flash of colo(u)r</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplescolorwheel-li><a href=/7/microcontrollers/02examples/colorwheel/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplescolorwheel><span>Color cycling</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplestouchkeyboard-li><a href=/7/microcontrollers/02examples/touchkeyboard/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplestouchkeyboard><span>Touch keyboard</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesneopixels-li><a href=/7/microcontrollers/02examples/neopixels/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesneopixels><span>Neopixels</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesneopixels2-li><a href=/7/microcontrollers/02examples/neopixels2/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesneopixels2><span>Neopixels (Part 2)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesneopixels3-li><a href=/7/microcontrollers/02examples/neopixels3/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesneopixels3><span>Neopixels (Part 3)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesneopixels4-li><a href=/7/microcontrollers/02examples/neopixels4/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesneopixels4><span>Neopixels (Part 4)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesneopixels5-li><a href=/7/microcontrollers/02examples/neopixels5/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesneopixels5><span>Neopixels (Part 5)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesneopixels6-li><a href=/7/microcontrollers/02examples/neopixels6/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesneopixels6><span>Neopixels (Part 6)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesneopixels7-li><a href=/7/microcontrollers/02examples/neopixels7/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesneopixels7><span>Neopixels (Part 7)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesphotocell-li><a href=/7/microcontrollers/02examples/photocell/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesphotocell><span>Photocell</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesvibration-li><a href=/7/microcontrollers/02examples/vibration/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesvibration><span>Vibration Sensor</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesalltogether-li><a href=/7/microcontrollers/02examples/alltogether/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesalltogether><span>Everything together</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers02examplesbuiltindemo-li><a href=/7/microcontrollers/02examples/builtindemo/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers02examplesbuiltindemo><span>Built-in example</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-7microcontrollers03basics-li><a href=/7/microcontrollers/03basics/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-7microcontrollers03basics><span>Learning the basics</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers03basicscircuitpython-li><a href=/7/microcontrollers/03basics/circuitpython/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers03basicscircuitpython><span>CircuitPython</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers03basicscounters-li><a href=/7/microcontrollers/03basics/counters/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers03basicscounters><span>Counters</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollers03basicscombiningcode-li><a href=/7/microcontrollers/03basics/combiningcode/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollers03basicscombiningcode><span></span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-7microcontrollersprojectideas-li><a href=/7/microcontrollers/projectideas/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-7microcontrollersprojectideas><span>Project ideas</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollersprojectideasbikelight-li><a href=/7/microcontrollers/projectideas/bikelight/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollersprojectideasbikelight><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-7microcontrollersprojectideascyclingcolours-li><a href=/7/microcontrollers/projectideas/cyclingcolours/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-7microcontrollersprojectideascyclingcolours><span>Cycling colours</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-7microcontrollersprojectideasonofflamp-li><a href=/7/microcontrollers/projectideas/onofflamp/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-7microcontrollersprojectideasonofflamp><span class=td-sidebar-nav-active-item>On-off lamp</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=https://tmcdigitech.github.io/7/microcontrollers/>Microcontrollers</a></li><li class=breadcrumb-item><a href=https://tmcdigitech.github.io/7/microcontrollers/projectideas/>Project ideas</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://tmcdigitech.github.io/7/microcontrollers/projectideas/onofflamp/ aria-disabled=true class="btn-link disabled">On-off lamp</a></li></ol></nav><div class=td-content><h1>On-off lamp</h1><header class=article-meta><p class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>&nbsp; 3 minute read &nbsp;</p></header><p>This example shows the basics of a <em>state machine</em>, also known by the
more technical term <em>finite state automaton</em>. The idea is that the
program is in a particular <em>state</em>, and certain <em>events</em> will cause
a <em>transition</em> to another state.</p><p>In our case, our light is either <em>on</em> or <em>off</em> (the states), and we
will transition between them with a big enough vibration reading.
Here is a <em>state diagram</em> of this:</p><pre tabindex=0><code class=language-mermaid data-lang=mermaid>stateDiagram-v2
    direction LR
    [*] --&gt; Off
    Off --&gt; On : if vibration &lt; 0.80 and ready
    On --&gt; Off : if vibration &lt; 0.80 and ready
</code></pre><p>Note the &ldquo;and ready&rdquo; condition. Given how fast the computer is,
when we tap the light, the vibration value will be less than 0.80 for
many cycles of the event loop, and without some care our light will
flash on and off rapidly, and be unpredictable.</p><p>Here is the complete code with several comments included.
We&rsquo;ll break it down below.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">77
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">78
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">79
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">80
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">81
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">82
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">83
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">84
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">85
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6272a4># Import libraries</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> time
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> neopixel
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> adafruit_dotstar
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> pulseio
</span></span><span style=display:flex><span><span style=color:#ff79c6>from</span> analogio <span style=color:#ff79c6>import</span> AnalogIn
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> board
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Set up neopixel light strip</span>
</span></span><span style=display:flex><span>pixpin <span style=color:#ff79c6>=</span> board<span style=color:#ff79c6>.</span>D0
</span></span><span style=display:flex><span>numpix <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>
</span></span><span style=display:flex><span>pixels <span style=color:#ff79c6>=</span> neopixel<span style=color:#ff79c6>.</span>NeoPixel(pixpin, numpix, brightness <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0.5</span>, auto_write<span style=color:#ff79c6>=</span><span style=color:#ff79c6>True</span>, pixel_order<span style=color:#ff79c6>=</span>neopixel<span style=color:#ff79c6>.</span>GRBW)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Built-in RGB light</span>
</span></span><span style=display:flex><span>dotstar <span style=color:#ff79c6>=</span> adafruit_dotstar<span style=color:#ff79c6>.</span>DotStar(board<span style=color:#ff79c6>.</span>APA102_SCK, board<span style=color:#ff79c6>.</span>APA102_MOSI, <span style=color:#bd93f9>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>vibrationPin <span style=color:#ff79c6>=</span> AnalogIn(board<span style=color:#ff79c6>.</span>A0)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>get_voltage</span>(pin):
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> (pin<span style=color:#ff79c6>.</span>value <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>3.3</span>) <span style=color:#ff79c6>/</span> <span style=color:#bd93f9>65536</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># A list of all the states, each uniquely numbered</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># (not important what the numbers are,</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># as long as they&#39;re unique)</span>
</span></span><span style=display:flex><span>OFF <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>ON <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Variable to keep track of which state we&#39;re in.</span>
</span></span><span style=display:flex><span>state <span style=color:#ff79c6>=</span> OFF
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Flag to keep track of whether we&#39;re &#34;ready&#34; or not</span>
</span></span><span style=display:flex><span>ready <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Counter to keep track of when the ready flag should be set</span>
</span></span><span style=display:flex><span>readyCounter <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Counter to print vibration value</span>
</span></span><span style=display:flex><span>printCounter <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Event loop</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>while</span> <span style=color:#ff79c6>True</span>:
</span></span><span style=display:flex><span>    vibration <span style=color:#ff79c6>=</span> get_voltage(vibrationPin)
</span></span><span style=display:flex><span>    <span style=color:#6272a4># Do code matching the current state, whether OFF or ON</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> state <span style=color:#ff79c6>==</span> OFF:
</span></span><span style=display:flex><span>        <span style=color:#6272a4># ensure light off</span>
</span></span><span style=display:flex><span>        pixels<span style=color:#ff79c6>.</span>fill((<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># check for events which cause transition from this state</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> vibration <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>0.8</span> <span style=color:#ff79c6>and</span> ready:
</span></span><span style=display:flex><span>            <span style=color:#6272a4># do anything we need to exit this state</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#6272a4># change state for next iteration of the loop</span>
</span></span><span style=display:flex><span>            state <span style=color:#ff79c6>=</span> ON
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#6272a4># do anything we need to enter new state</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#6272a4># Make us not ready, and set the ready counter</span>
</span></span><span style=display:flex><span>            ready <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>False</span>
</span></span><span style=display:flex><span>            readyCounter <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>100</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>elif</span> state <span style=color:#ff79c6>==</span> ON:
</span></span><span style=display:flex><span>        <span style=color:#6272a4># ensure light on</span>
</span></span><span style=display:flex><span>        pixels[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>=</span> (<span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span>        pixels[<span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>=</span> (<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span>        pixels[<span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> (<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#6272a4># check for events</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> vibration <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>0.8</span> <span style=color:#ff79c6>and</span> ready:
</span></span><span style=display:flex><span>            state <span style=color:#ff79c6>=</span> OFF
</span></span><span style=display:flex><span>            ready <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>False</span>
</span></span><span style=display:flex><span>            readyCounter <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>100</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#6272a4># Handle the counters</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> readyCounter <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>0</span>:
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Decrement the counter</span>
</span></span><span style=display:flex><span>        readyCounter <span style=color:#ff79c6>-=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># If zero, we&#39;re &#34;ready&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> readyCounter <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>:
</span></span><span style=display:flex><span>            ready <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>True</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> printCounter <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>:
</span></span><span style=display:flex><span>        <span style=color:#8be9fd;font-style:italic>print</span>(state, ready, vibration)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    printCounter <span style=color:#ff79c6>=</span> (printCounter <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>10</span>
</span></span></code></pre></td></tr></table></div></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Thomas More College" aria-label="Thomas More College"><a class=text-white target=_blank rel=noopener href=https://www.tmc.catholic.edu.au aria-label="Thomas More College"><i class="fa fa-school"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/tmcdigitech/seven aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Python aria-label=Python><a class=text-white target=_blank rel=noopener href=https://example.org/mail aria-label=Python><i class="fab fa-python"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer></div><script src=/7/js/main.min.f1a20e761a85478d0ce3298a01e295324be8858ef8f2d2baac6737980799b320.js integrity="sha256-8aIOdhqFR40M4ymKAeKVMkvohY748tK6rGc3mAeZsyA=" crossorigin=anonymous></script>
<script src=/7/js/tabpane-persist.js></script></body></html>